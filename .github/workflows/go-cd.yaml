name: Go - CD

on:
  push:
    branches:
      - main
      - next
      - dev
    paths:
      - '**go.mod'
      - '**go.sum'
      - '**.go'
  workflow_dispatch:
    inputs:
      force-rollback:
        description: Force rollback to specified git reference (use `latest` for latest successful deploy)
        type: string
        default: ''
        required: false

jobs:
  go-cd:
    name: Go - CD
    uses: kemadev/workflows-and-actions/.github/workflows/go-cd.yaml@main
    with:
      force-rollback: ${{ github.event.inputs.force-rollback }}
    permissions:
      contents: write
      packages: write
      pull-requests: write
